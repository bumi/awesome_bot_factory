require "spec_helper"

describe <%= skill_class_name %> do
  
  subject { AirportCode.new(AwesomeBotFactory::ExamplePayload.new("match" => ["bot:dance around the world", "dance", "around", "the world"])) }
  
  it { should have_matches_for(:command, :of, :matches) }
  its(:command) { should eql("dance") }
  its(:reply) { should eql({ :type => "TextMessage", :body => "hello world" })}
  
  describe "as a rack application" do
    let(:app) { AirportCode }
    before do
      post "/<%= skill_file_name %>", {}, :input => <%= skill_file_name %>_payload.to_json
    end
    let(:json_body) { JSON.parse(last_response.body) }

    it { last_response.should be_ok }
    it { json_body["type"].should eql("TextMessage") }
    it { json_body["body"].should eql("hello world") }
  end
end
